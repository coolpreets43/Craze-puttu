
package com.cts.iterate;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Properties;

import com.cts.iterate.Xmltoexcel;

import javancss.*;

public class FolderIterator {
public static void main(String args[]) throws IOException
{
  String path="D:\\MainFolder";
    searchFolders(new File(path));
    System.out.println("Done");
}
public static void searchFolders(File fo) throws IOException
{
	String strdir="D:\\MainFolder\\target";
	boolean success=(new File(strdir)).mkdir();
	if(success)
	{
		System.out.println("directory"+strdir+"created");
	}
	
	if(fo.isDirectory())
	{
		System.out.println("Searching in..." + fo.getName());
		String internalNames[] = fo.list();  
		int count=internalNames.length;
		System.out.println(count);
	
		for(int i=0; i<internalNames.length; i++)     
		{           
			
			System.out.println(internalNames[i]);
			try {
						
			String pathname=fo.getAbsolutePath() + "\\" + internalNames[i];
			String pth=fo.getCanonicalPath();
			System.out.println(pth);
			System.out.println(pathname);
			String appNAME[]=internalNames;
			
			String xmlpath=strdir+"\\"+appNAME[i]+".xml";
			String excelpath=strdir+"\\"+"AllExcelSheets.xls";
			
			String[] asArgs = { "-all", "-xml", "-recursive", pathname, "-out",
					xmlpath };
			
				Javancss pJavancss = new Javancss(asArgs, "");
				if (pJavancss.getLastErrorMessage() != null) {
						System.out.println("Report Generatation faild ...!");
				        System.exit(1);
				}
				else{
					System.out.println("Main ...!");
					File xmlDocument = new File(xmlpath);
					System.out.println("ipfName ...!"+xmlpath);
					Xmltoexcel excel = new Xmltoexcel();
					
					boolean bFlag = excel.generateExcel(xmlDocument, excelpath, appNAME, count);
					System.out.println("bFlag ...!"+bFlag);
					if (bFlag)
						System.out.println("Report Generated ... ");
					else
						System.out.println("Report Generatation faild ...!");
				}
				          
				
			} catch (IOException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}	
			
			
			
			
		}
		
		
		 
	}
	
	
	
	
}

}
